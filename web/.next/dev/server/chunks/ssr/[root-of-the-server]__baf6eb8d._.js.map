{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/lib/api.ts"],"sourcesContent":["// API Client for Vizora Middleware\n\nimport type { Display, Content, Playlist, PlaylistItem, Schedule, PaginatedResponse } from './types';\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000/api';\n\nclass ApiClient {\n  private baseUrl: string;\n  private token: string | null = null;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n    // Load token from localStorage if available\n    if (typeof window !== 'undefined') {\n      this.token = localStorage.getItem('authToken');\n    }\n  }\n\n  setToken(token: string) {\n    this.token = token;\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('authToken', token);\n      // Also set as cookie for middleware to access\n      document.cookie = `authToken=${token}; path=/; max-age=604800; SameSite=Lax`;\n      console.log('[API] Token saved to both localStorage and cookie');\n    }\n  }\n\n  clearToken() {\n    this.token = null;\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('authToken');\n      // Also clear cookie\n      document.cookie = 'authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n      console.log('[API] Token cleared from both localStorage and cookie');\n    }\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n      ...(this.token && { Authorization: `Bearer ${this.token}` }),\n      ...options.headers,\n    };\n\n    console.log(`[API] Request: ${options.method || 'GET'} ${this.baseUrl}${endpoint}`);\n\n    const response = await fetch(`${this.baseUrl}${endpoint}`, {\n      ...options,\n      headers,\n    });\n\n    console.log(`[API] Response status: ${response.status} ${response.statusText}`);\n\n    if (!response.ok) {\n      console.error(`[API] Request failed with status ${response.status}`);\n      // Handle authentication errors\n      if (response.status === 401 || response.status === 403) {\n        this.clearToken();\n        if (typeof window !== 'undefined') {\n          // Redirect to login with return URL\n          const currentPath = window.location.pathname;\n          window.location.href = `/login?redirect=${encodeURIComponent(currentPath)}`;\n        }\n      }\n\n      const error = await response.json().catch(() => ({ message: 'Request failed' }));\n      throw new Error(error.message || `HTTP ${response.status}`);\n    }\n\n    const data = await response.json();\n    console.log('[API] Response data:', data);\n    return data;\n  }\n\n  // Auth\n  async login(email: string, password: string) {\n    console.log('[API] Login called with email:', email);\n    const response = await this.request<{ \n      success: boolean;\n      data: { \n        user: any;\n        token: string;\n        expiresIn: number;\n      }\n    }>('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({ email, password }),\n    });\n    console.log('[API] Login response received:', response);\n    console.log('[API] Response structure:', {\n      hasSuccess: 'success' in response,\n      hasData: 'data' in response,\n      dataType: typeof response.data,\n      hasToken: response.data?.token !== undefined,\n      tokenValue: response.data?.token ? response.data.token.substring(0, 30) + '...' : 'MISSING'\n    });\n    \n    if (response.data && response.data.token) {\n      console.log('[API] ✅ Token found, calling setToken()');\n      this.setToken(response.data.token);\n      console.log('[API] ✅ Token saved to localStorage');\n    } else {\n      console.error('[API] ❌ TOKEN NOT FOUND in response!');\n      console.error('[API] Response:', JSON.stringify(response, null, 2));\n    }\n    return response.data;\n  }\n\n  async register(\n    email: string, \n    password: string, \n    organizationName: string,\n    firstName: string,\n    lastName: string\n  ) {\n    console.log('[API] Register called');\n    const response = await this.request<{\n      success: boolean;\n      data: {\n        user: any;\n        organization: any;\n        token: string;\n        expiresIn: number;\n      }\n    }>('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify({ \n        email, \n        password, \n        organizationName,\n        firstName,\n        lastName,\n      }),\n    });\n    console.log('[API] Register response received:', response);\n    console.log('[API] Response structure:', {\n      hasSuccess: 'success' in response,\n      hasData: 'data' in response,\n      hasToken: response.data?.token !== undefined,\n      tokenValue: response.data?.token ? response.data.token.substring(0, 30) + '...' : 'MISSING'\n    });\n    \n    if (response.data && response.data.token) {\n      console.log('[API] ✅ Token found in register, calling setToken()');\n      this.setToken(response.data.token);\n      console.log('[API] ✅ Token saved to localStorage');\n    } else {\n      console.error('[API] ❌ TOKEN NOT FOUND in register response!');\n    }\n    return response.data;\n  }\n\n  // Displays\n  async getDisplays(params?: { page?: number; limit?: number }): Promise<PaginatedResponse<Display>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Display>>(`/displays${query ? `?${query}` : ''}`);\n  }\n\n  async getDisplay(id: string): Promise<Display> {\n    return this.request<Display>(`/displays/${id}`);\n  }\n\n  async createDisplay(data: { nickname: string; location?: string }): Promise<Display> {\n    // Backend expects 'name' and 'deviceId', frontend uses 'nickname'\n    const payload = {\n      name: data.nickname,\n      location: data.location,\n      deviceId: `device-${Date.now()}-${Math.random().toString(36).substring(7)}`, // Generate unique device ID\n    };\n    return this.request<Display>('/displays', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async updateDisplay(id: string, data: Partial<{ nickname: string; location?: string; currentPlaylistId?: string }>): Promise<Display> {\n    // Backend expects 'name', frontend uses 'nickname'\n    const payload: any = {};\n    if (data.nickname !== undefined) payload.name = data.nickname;\n    if (data.location !== undefined) payload.location = data.location;\n    if (data.currentPlaylistId !== undefined) payload.currentPlaylistId = data.currentPlaylistId;\n    \n    return this.request<Display>(`/displays/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async deleteDisplay(id: string): Promise<void> {\n    return this.request<void>(`/displays/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async generatePairingToken(id: string): Promise<{ pairingCode: string }> {\n    return this.request<{ pairingCode: string }>(`/displays/${id}/pair`, {\n      method: 'POST',\n    });\n  }\n\n  async completePairing(data: { code: string; nickname: string; location?: string }): Promise<any> {\n    return this.request<any>('/devices/pairing/complete', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  // Content\n  async getContent(params?: { page?: number; limit?: number; type?: string; status?: string }): Promise<PaginatedResponse<Content>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Content>>(`/content${query ? `?${query}` : ''}`);\n  }\n\n  async getContentItem(id: string): Promise<Content> {\n    return this.request<Content>(`/content/${id}`);\n  }\n\n  async createContent(data: {\n    title: string;\n    type: string;\n    url?: string;\n    metadata?: any;\n  }): Promise<Content> {\n    // Backend expects 'name' instead of 'title'\n    const payload = {\n      name: data.title,\n      type: data.type === 'pdf' ? 'url' : data.type, // Map pdf to url type\n      url: data.url || '',\n      metadata: data.metadata,\n    };\n    return this.request<Content>('/content', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async updateContent(id: string, data: Partial<{ title: string; metadata?: any }>): Promise<Content> {\n    return this.request<Content>(`/content/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deleteContent(id: string): Promise<void> {\n    return this.request<void>(`/content/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async archiveContent(id: string): Promise<Content> {\n    return this.request<Content>(`/content/${id}/archive`, {\n      method: 'POST',\n    });\n  }\n\n  // Playlists\n  async getPlaylists(params?: { page?: number; limit?: number }): Promise<PaginatedResponse<Playlist>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Playlist>>(`/playlists${query ? `?${query}` : ''}`);\n  }\n\n  async getPlaylist(id: string): Promise<Playlist> {\n    return this.request<Playlist>(`/playlists/${id}`);\n  }\n\n  async createPlaylist(data: {\n    name: string;\n    description?: string;\n    items?: Array<{ contentId: string; duration?: number }>;\n  }): Promise<Playlist> {\n    return this.request<Playlist>('/playlists', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async updatePlaylist(id: string, data: Partial<{\n    name: string;\n    description?: string;\n  }>): Promise<Playlist> {\n    return this.request<Playlist>(`/playlists/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deletePlaylist(id: string): Promise<void> {\n    return this.request<void>(`/playlists/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async addPlaylistItem(playlistId: string, contentId: string, duration?: number): Promise<PlaylistItem> {\n    return this.request<PlaylistItem>(`/playlists/${playlistId}/items`, {\n      method: 'POST',\n      body: JSON.stringify({ contentId, duration }),\n    });\n  }\n\n  async removePlaylistItem(playlistId: string, itemId: string): Promise<void> {\n    return this.request<void>(`/playlists/${playlistId}/items/${itemId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async updatePlaylistItem(playlistId: string, itemId: string, data: { duration?: number }): Promise<PlaylistItem> {\n    return this.request<PlaylistItem>(`/playlists/${playlistId}/items/${itemId}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  // Schedules\n  async getSchedules(params?: { page?: number; limit?: number }) {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<any>(`/schedules${query ? `?${query}` : ''}`);\n  }\n\n  async createSchedule(data: any) {\n    return this.request<any>('/schedules', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async updateSchedule(id: string, data: any) {\n    return this.request<any>(`/schedules/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deleteSchedule(id: string) {\n    return this.request<any>(`/schedules/${id}`, {\n      method: 'DELETE',\n    });\n  }\n}\n\nexport const apiClient = new ApiClient(API_BASE_URL);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/components/LoadingSpinner.tsx"],"sourcesContent":["export default function LoadingSpinner({ size = 'md' }: { size?: 'sm' | 'md' | 'lg' }) {\n  const sizeClasses = {\n    sm: 'w-4 h-4',\n    md: 'w-8 h-8',\n    lg: 'w-12 h-12',\n  };\n\n  return (\n    <div className=\"flex items-center justify-center\">\n      <div\n        className={`${sizeClasses[size]} border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin`}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAe,SAAS,eAAe,EAAE,OAAO,IAAI,EAAiC;IACnF,MAAM,cAAc;QAClB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,6VAAC;QAAI,WAAU;kBACb,cAAA,6VAAC;YACC,WAAW,GAAG,WAAW,CAAC,KAAK,CAAC,qEAAqE,CAAC;;;;;;;;;;;AAI9G"}},
    {"offset": {"line": 328, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/components/Button.tsx"],"sourcesContent":["'use client';\n\nimport { ButtonHTMLAttributes } from 'react';\nimport LoadingSpinner from './LoadingSpinner';\n\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'primary' | 'secondary' | 'danger' | 'success';\n  size?: 'sm' | 'md' | 'lg';\n  loading?: boolean;\n  children: React.ReactNode;\n}\n\nexport default function Button({\n  variant = 'primary',\n  size = 'md',\n  loading = false,\n  disabled,\n  children,\n  className = '',\n  ...props\n}: ButtonProps) {\n  const baseClasses = 'font-semibold rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2';\n  \n  const variantClasses = {\n    primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500',\n    secondary: 'bg-gray-200 text-gray-700 hover:bg-gray-300 focus:ring-gray-500',\n    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',\n    success: 'bg-green-600 text-white hover:bg-green-700 focus:ring-green-500',\n  };\n  \n  const sizeClasses = {\n    sm: 'px-3 py-1.5 text-sm',\n    md: 'px-4 py-2 text-sm',\n    lg: 'px-6 py-3 text-base',\n  };\n\n  return (\n    <button\n      className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${className}`}\n      disabled={disabled || loading}\n      {...props}\n    >\n      {loading && <LoadingSpinner size=\"sm\" />}\n      {children}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAYe,SAAS,OAAO,EAC7B,UAAU,SAAS,EACnB,OAAO,IAAI,EACX,UAAU,KAAK,EACf,QAAQ,EACR,QAAQ,EACR,YAAY,EAAE,EACd,GAAG,OACS;IACZ,MAAM,cAAc;IAEpB,MAAM,iBAAiB;QACrB,SAAS;QACT,WAAW;QACX,QAAQ;QACR,SAAS;IACX;IAEA,MAAM,cAAc;QAClB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,6VAAC;QACC,WAAW,GAAG,YAAY,CAAC,EAAE,cAAc,CAAC,QAAQ,CAAC,CAAC,EAAE,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,WAAW;QACxF,UAAU,YAAY;QACrB,GAAG,KAAK;;YAER,yBAAW,6VAAC,sJAAc;gBAAC,MAAK;;;;;;YAChC;;;;;;;AAGP"}},
    {"offset": {"line": 374, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport Link from 'next/link';\nimport { apiClient } from '@/lib/api';\nimport { loginSchema } from '@/lib/validation';\nimport Button from '@/components/Button';\nimport { z } from 'zod';\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const redirectUrl = searchParams.get('redirect') || '/dashboard';\n  \n  const [formData, setFormData] = useState({ email: '', password: '' });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    setErrors({});\n\n    // Validate form\n    const validation = validateForm(formData, {\n      email: { \n        required: true,\n        custom: validators.email,\n      },\n      password: { \n        required: true,\n        minLength: 6,\n      },\n    });\n\n    if (!validation.isValid) {\n      setErrors(validation.errors);\n      setLoading(false);\n      return;\n    }\n\n    try {\n      await apiClient.login(formData.email, formData.password);\n      console.log('[LOGIN] Login successful, redirecting to:', redirectUrl);\n      router.push(redirectUrl);\n      console.log('[LOGIN] Router.push called');\n    } catch (err: any) {\n      console.error('[LOGIN] Login error:', err);\n      setError(err.message || 'Login failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n      <div className=\"bg-white p-8 rounded-lg shadow-lg w-full max-w-md\">\n        <h1 className=\"text-3xl font-bold text-center mb-6\">Login to Vizora</h1>\n\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Email\n            </label>\n            <input\n              type=\"email\"\n              value={formData.email}\n              onChange={(e) => {\n                setFormData({ ...formData, email: e.target.value });\n                if (errors.email) setErrors({ ...errors, email: '' });\n              }}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-900 ${\n                errors.email ? 'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-blue-500'\n              }`}\n              placeholder=\"you@example.com\"\n              aria-label=\"Email address\"\n              aria-invalid={!!errors.email}\n              aria-describedby={errors.email ? 'email-error' : undefined}\n            />\n            {errors.email && (\n              <p id=\"email-error\" className=\"mt-1 text-sm text-red-600\" role=\"alert\">\n                {errors.email}\n              </p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              value={formData.password}\n              onChange={(e) => {\n                setFormData({ ...formData, password: e.target.value });\n                if (errors.password) setErrors({ ...errors, password: '' });\n              }}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-900 ${\n                errors.password ? 'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-blue-500'\n              }`}\n              placeholder=\"••••••••\"\n              aria-label=\"Password\"\n              aria-invalid={!!errors.password}\n              aria-describedby={errors.password ? 'password-error' : undefined}\n            />\n            {errors.password && (\n              <p id=\"password-error\" className=\"mt-1 text-sm text-red-600\" role=\"alert\">\n                {errors.password}\n              </p>\n            )}\n          </div>\n\n          <Button\n            type=\"submit\"\n            loading={loading}\n            className=\"w-full\"\n            aria-label=\"Log in to your account\"\n          >\n            Login\n          </Button>\n        </form>\n\n        <p className=\"text-center mt-6 text-gray-600\">\n          Don't have an account?{' '}\n          <Link href=\"/register\" className=\"text-blue-600 hover:underline\">\n            Sign up\n          </Link>\n        </p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}