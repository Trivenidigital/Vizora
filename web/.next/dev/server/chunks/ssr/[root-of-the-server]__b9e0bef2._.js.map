{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/lib/api.ts"],"sourcesContent":["// API Client for Vizora Middleware\n\nimport type { Display, Content, Playlist, PlaylistItem, Schedule, PaginatedResponse } from './types';\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000/api';\n\nclass ApiClient {\n  private baseUrl: string;\n  private token: string | null = null;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n    // Load token from localStorage if available\n    if (typeof window !== 'undefined') {\n      this.token = localStorage.getItem('authToken');\n    }\n  }\n\n  setToken(token: string) {\n    this.token = token;\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('authToken', token);\n      // Also set as cookie for middleware to access\n      document.cookie = `authToken=${token}; path=/; max-age=604800; SameSite=Lax`;\n      console.log('[API] Token saved to both localStorage and cookie');\n    }\n  }\n\n  clearToken() {\n    this.token = null;\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('authToken');\n      // Also clear cookie\n      document.cookie = 'authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n      console.log('[API] Token cleared from both localStorage and cookie');\n    }\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n      ...(this.token && { Authorization: `Bearer ${this.token}` }),\n      ...options.headers,\n    };\n\n    console.log(`[API] Request: ${options.method || 'GET'} ${this.baseUrl}${endpoint}`);\n\n    const response = await fetch(`${this.baseUrl}${endpoint}`, {\n      ...options,\n      headers,\n    });\n\n    console.log(`[API] Response status: ${response.status} ${response.statusText}`);\n\n    if (!response.ok) {\n      console.error(`[API] Request failed with status ${response.status}`);\n      // Handle authentication errors\n      if (response.status === 401 || response.status === 403) {\n        this.clearToken();\n        if (typeof window !== 'undefined') {\n          // Redirect to login with return URL\n          const currentPath = window.location.pathname;\n          window.location.href = `/login?redirect=${encodeURIComponent(currentPath)}`;\n        }\n      }\n\n      const error = await response.json().catch(() => ({ message: 'Request failed' }));\n      throw new Error(error.message || `HTTP ${response.status}`);\n    }\n\n    const data = await response.json();\n    console.log('[API] Response data:', data);\n    return data;\n  }\n\n  // Auth\n  async login(email: string, password: string) {\n    console.log('[API] Login called with email:', email);\n    const response = await this.request<{ \n      success: boolean;\n      data: { \n        user: any;\n        token: string;\n        expiresIn: number;\n      }\n    }>('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({ email, password }),\n    });\n    console.log('[API] Login response received:', response);\n    console.log('[API] Response structure:', {\n      hasSuccess: 'success' in response,\n      hasData: 'data' in response,\n      dataType: typeof response.data,\n      hasToken: response.data?.token !== undefined,\n      tokenValue: response.data?.token ? response.data.token.substring(0, 30) + '...' : 'MISSING'\n    });\n    \n    if (response.data && response.data.token) {\n      console.log('[API] ‚úÖ Token found, calling setToken()');\n      this.setToken(response.data.token);\n      console.log('[API] ‚úÖ Token saved to localStorage');\n    } else {\n      console.error('[API] ‚ùå TOKEN NOT FOUND in response!');\n      console.error('[API] Response:', JSON.stringify(response, null, 2));\n    }\n    return response.data;\n  }\n\n  async register(\n    email: string, \n    password: string, \n    organizationName: string,\n    firstName: string,\n    lastName: string\n  ) {\n    console.log('[API] Register called');\n    const response = await this.request<{\n      success: boolean;\n      data: {\n        user: any;\n        organization: any;\n        token: string;\n        expiresIn: number;\n      }\n    }>('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify({ \n        email, \n        password, \n        organizationName,\n        firstName,\n        lastName,\n      }),\n    });\n    console.log('[API] Register response received:', response);\n    console.log('[API] Response structure:', {\n      hasSuccess: 'success' in response,\n      hasData: 'data' in response,\n      hasToken: response.data?.token !== undefined,\n      tokenValue: response.data?.token ? response.data.token.substring(0, 30) + '...' : 'MISSING'\n    });\n    \n    if (response.data && response.data.token) {\n      console.log('[API] ‚úÖ Token found in register, calling setToken()');\n      this.setToken(response.data.token);\n      console.log('[API] ‚úÖ Token saved to localStorage');\n    } else {\n      console.error('[API] ‚ùå TOKEN NOT FOUND in register response!');\n    }\n    return response.data;\n  }\n\n  // Displays\n  async getDisplays(params?: { page?: number; limit?: number }): Promise<PaginatedResponse<Display>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Display>>(`/displays${query ? `?${query}` : ''}`);\n  }\n\n  async getDisplay(id: string): Promise<Display> {\n    return this.request<Display>(`/displays/${id}`);\n  }\n\n  async createDisplay(data: { nickname: string; location?: string }): Promise<Display> {\n    // Backend expects 'name' and 'deviceId', frontend uses 'nickname'\n    const payload = {\n      name: data.nickname,\n      location: data.location,\n      deviceId: `device-${Date.now()}-${Math.random().toString(36).substring(7)}`, // Generate unique device ID\n    };\n    return this.request<Display>('/displays', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async updateDisplay(id: string, data: Partial<{ nickname: string; location?: string; currentPlaylistId?: string }>): Promise<Display> {\n    // Backend expects 'name', frontend uses 'nickname'\n    const payload: any = {};\n    if (data.nickname !== undefined) payload.name = data.nickname;\n    if (data.location !== undefined) payload.location = data.location;\n    if (data.currentPlaylistId !== undefined) payload.currentPlaylistId = data.currentPlaylistId;\n    \n    return this.request<Display>(`/displays/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async deleteDisplay(id: string): Promise<void> {\n    return this.request<void>(`/displays/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async generatePairingToken(id: string): Promise<{ pairingCode: string }> {\n    return this.request<{ pairingCode: string }>(`/displays/${id}/pair`, {\n      method: 'POST',\n    });\n  }\n\n  async completePairing(data: { code: string; nickname: string; location?: string }): Promise<any> {\n    return this.request<any>('/devices/pairing/complete', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  // Content\n  async getContent(params?: { page?: number; limit?: number; type?: string; status?: string }): Promise<PaginatedResponse<Content>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Content>>(`/content${query ? `?${query}` : ''}`);\n  }\n\n  async getContentItem(id: string): Promise<Content> {\n    return this.request<Content>(`/content/${id}`);\n  }\n\n  async createContent(data: {\n    title: string;\n    type: string;\n    url?: string;\n    metadata?: any;\n  }): Promise<Content> {\n    // Backend expects 'name' instead of 'title'\n    const payload = {\n      name: data.title,\n      type: data.type === 'pdf' ? 'url' : data.type, // Map pdf to url type\n      url: data.url || '',\n      metadata: data.metadata,\n    };\n    return this.request<Content>('/content', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async updateContent(id: string, data: Partial<{ title: string; metadata?: any }>): Promise<Content> {\n    return this.request<Content>(`/content/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deleteContent(id: string): Promise<void> {\n    return this.request<void>(`/content/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async archiveContent(id: string): Promise<Content> {\n    return this.request<Content>(`/content/${id}/archive`, {\n      method: 'POST',\n    });\n  }\n\n  // Playlists\n  async getPlaylists(params?: { page?: number; limit?: number }): Promise<PaginatedResponse<Playlist>> {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<PaginatedResponse<Playlist>>(`/playlists${query ? `?${query}` : ''}`);\n  }\n\n  async getPlaylist(id: string): Promise<Playlist> {\n    return this.request<Playlist>(`/playlists/${id}`);\n  }\n\n  async createPlaylist(data: {\n    name: string;\n    description?: string;\n    items?: Array<{ contentId: string; duration?: number }>;\n  }): Promise<Playlist> {\n    return this.request<Playlist>('/playlists', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async updatePlaylist(id: string, data: Partial<{\n    name: string;\n    description?: string;\n  }>): Promise<Playlist> {\n    return this.request<Playlist>(`/playlists/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deletePlaylist(id: string): Promise<void> {\n    return this.request<void>(`/playlists/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async addPlaylistItem(playlistId: string, contentId: string, duration?: number): Promise<PlaylistItem> {\n    return this.request<PlaylistItem>(`/playlists/${playlistId}/items`, {\n      method: 'POST',\n      body: JSON.stringify({ contentId, duration }),\n    });\n  }\n\n  async removePlaylistItem(playlistId: string, itemId: string): Promise<void> {\n    return this.request<void>(`/playlists/${playlistId}/items/${itemId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // Schedules\n  async getSchedules(params?: { page?: number; limit?: number }) {\n    const query = new URLSearchParams(params as any).toString();\n    return this.request<any>(`/schedules${query ? `?${query}` : ''}`);\n  }\n\n  async createSchedule(data: any) {\n    return this.request<any>('/schedules', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async updateSchedule(id: string, data: any) {\n    return this.request<any>(`/schedules/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deleteSchedule(id: string) {\n    return this.request<any>(`/schedules/${id}`, {\n      method: 'DELETE',\n    });\n  }\n}\n\nexport const apiClient = new ApiClient(API_BASE_URL);\n"],"names":[],"mappings":"AAAA,mCAAmC;;;;;AAInC,MAAM,eAAe,iEAAmC;AAExD,MAAM;IACI,QAAgB;IAChB,QAAuB,KAAK;IAEpC,YAAY,OAAe,CAAE;QAC3B,IAAI,CAAC,OAAO,GAAG;QACf,4CAA4C;QAC5C;;IAGF;IAEA,SAAS,KAAa,EAAE;QACtB,IAAI,CAAC,KAAK,GAAG;QACb;;IAMF;IAEA,aAAa;QACX,IAAI,CAAC,KAAK,GAAG;QACb;;IAMF;IAEA,MAAc,QACZ,QAAgB,EAChB,UAAuB,CAAC,CAAC,EACb;QACZ,MAAM,UAAuB;YAC3B,gBAAgB;YAChB,GAAI,IAAI,CAAC,KAAK,IAAI;gBAAE,eAAe,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,EAAE;YAAC,CAAC;YAC3D,GAAG,QAAQ,OAAO;QACpB;QAEA,QAAQ,GAAG,CAAC,CAAC,eAAe,EAAE,QAAQ,MAAM,IAAI,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,GAAG,UAAU;QAElF,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,UAAU,EAAE;YACzD,GAAG,OAAO;YACV;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,EAAE;QAE9E,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,CAAC,iCAAiC,EAAE,SAAS,MAAM,EAAE;YACnE,+BAA+B;YAC/B,IAAI,SAAS,MAAM,KAAK,OAAO,SAAS,MAAM,KAAK,KAAK;gBACtD,IAAI,CAAC,UAAU;gBACf;;YAKF;YAEA,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;oBAAE,SAAS;gBAAiB,CAAC;YAC9E,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI,CAAC,KAAK,EAAE,SAAS,MAAM,EAAE;QAC5D;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,QAAQ,GAAG,CAAC,wBAAwB;QACpC,OAAO;IACT;IAEA,OAAO;IACP,MAAM,MAAM,KAAa,EAAE,QAAgB,EAAE;QAC3C,QAAQ,GAAG,CAAC,kCAAkC;QAC9C,MAAM,WAAW,MAAM,IAAI,CAAC,OAAO,CAOhC,eAAe;YAChB,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;QACA,QAAQ,GAAG,CAAC,kCAAkC;QAC9C,QAAQ,GAAG,CAAC,6BAA6B;YACvC,YAAY,aAAa;YACzB,SAAS,UAAU;YACnB,UAAU,OAAO,SAAS,IAAI;YAC9B,UAAU,SAAS,IAAI,EAAE,UAAU;YACnC,YAAY,SAAS,IAAI,EAAE,QAAQ,SAAS,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,MAAM,QAAQ;QACpF;QAEA,IAAI,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,KAAK,EAAE;YACxC,QAAQ,GAAG,CAAC;YACZ,IAAI,CAAC,QAAQ,CAAC,SAAS,IAAI,CAAC,KAAK;YACjC,QAAQ,GAAG,CAAC;QACd,OAAO;YACL,QAAQ,KAAK,CAAC;YACd,QAAQ,KAAK,CAAC,mBAAmB,KAAK,SAAS,CAAC,UAAU,MAAM;QAClE;QACA,OAAO,SAAS,IAAI;IACtB;IAEA,MAAM,SACJ,KAAa,EACb,QAAgB,EAChB,gBAAwB,EACxB,SAAiB,EACjB,QAAgB,EAChB;QACA,QAAQ,GAAG,CAAC;QACZ,MAAM,WAAW,MAAM,IAAI,CAAC,OAAO,CAQhC,kBAAkB;YACnB,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBACnB;gBACA;gBACA;gBACA;gBACA;YACF;QACF;QACA,QAAQ,GAAG,CAAC,qCAAqC;QACjD,QAAQ,GAAG,CAAC,6BAA6B;YACvC,YAAY,aAAa;YACzB,SAAS,UAAU;YACnB,UAAU,SAAS,IAAI,EAAE,UAAU;YACnC,YAAY,SAAS,IAAI,EAAE,QAAQ,SAAS,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,MAAM,QAAQ;QACpF;QAEA,IAAI,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,KAAK,EAAE;YACxC,QAAQ,GAAG,CAAC;YACZ,IAAI,CAAC,QAAQ,CAAC,SAAS,IAAI,CAAC,KAAK;YACjC,QAAQ,GAAG,CAAC;QACd,OAAO;YACL,QAAQ,KAAK,CAAC;QAChB;QACA,OAAO,SAAS,IAAI;IACtB;IAEA,WAAW;IACX,MAAM,YAAY,MAA0C,EAAuC;QACjG,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,IAAI,CAAC,OAAO,CAA6B,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IACxF;IAEA,MAAM,WAAW,EAAU,EAAoB;QAC7C,OAAO,IAAI,CAAC,OAAO,CAAU,CAAC,UAAU,EAAE,IAAI;IAChD;IAEA,MAAM,cAAc,IAA6C,EAAoB;QACnF,kEAAkE;QAClE,MAAM,UAAU;YACd,MAAM,KAAK,QAAQ;YACnB,UAAU,KAAK,QAAQ;YACvB,UAAU,CAAC,OAAO,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,IAAI;QAC7E;QACA,OAAO,IAAI,CAAC,OAAO,CAAU,aAAa;YACxC,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,cAAc,EAAU,EAAE,IAAkF,EAAoB;QACpI,mDAAmD;QACnD,MAAM,UAAe,CAAC;QACtB,IAAI,KAAK,QAAQ,KAAK,WAAW,QAAQ,IAAI,GAAG,KAAK,QAAQ;QAC7D,IAAI,KAAK,QAAQ,KAAK,WAAW,QAAQ,QAAQ,GAAG,KAAK,QAAQ;QACjE,IAAI,KAAK,iBAAiB,KAAK,WAAW,QAAQ,iBAAiB,GAAG,KAAK,iBAAiB;QAE5F,OAAO,IAAI,CAAC,OAAO,CAAU,CAAC,UAAU,EAAE,IAAI,EAAE;YAC9C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,cAAc,EAAU,EAAiB;QAC7C,OAAO,IAAI,CAAC,OAAO,CAAO,CAAC,UAAU,EAAE,IAAI,EAAE;YAC3C,QAAQ;QACV;IACF;IAEA,MAAM,qBAAqB,EAAU,EAAoC;QACvE,OAAO,IAAI,CAAC,OAAO,CAA0B,CAAC,UAAU,EAAE,GAAG,KAAK,CAAC,EAAE;YACnE,QAAQ;QACV;IACF;IAEA,MAAM,gBAAgB,IAA2D,EAAgB;QAC/F,OAAO,IAAI,CAAC,OAAO,CAAM,6BAA6B;YACpD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,UAAU;IACV,MAAM,WAAW,MAA0E,EAAuC;QAChI,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,IAAI,CAAC,OAAO,CAA6B,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IACvF;IAEA,MAAM,eAAe,EAAU,EAAoB;QACjD,OAAO,IAAI,CAAC,OAAO,CAAU,CAAC,SAAS,EAAE,IAAI;IAC/C;IAEA,MAAM,cAAc,IAKnB,EAAoB;QACnB,4CAA4C;QAC5C,MAAM,UAAU;YACd,MAAM,KAAK,KAAK;YAChB,MAAM,KAAK,IAAI,KAAK,QAAQ,QAAQ,KAAK,IAAI;YAC7C,KAAK,KAAK,GAAG,IAAI;YACjB,UAAU,KAAK,QAAQ;QACzB;QACA,OAAO,IAAI,CAAC,OAAO,CAAU,YAAY;YACvC,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,cAAc,EAAU,EAAE,IAAgD,EAAoB;QAClG,OAAO,IAAI,CAAC,OAAO,CAAU,CAAC,SAAS,EAAE,IAAI,EAAE;YAC7C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,cAAc,EAAU,EAAiB;QAC7C,OAAO,IAAI,CAAC,OAAO,CAAO,CAAC,SAAS,EAAE,IAAI,EAAE;YAC1C,QAAQ;QACV;IACF;IAEA,MAAM,eAAe,EAAU,EAAoB;QACjD,OAAO,IAAI,CAAC,OAAO,CAAU,CAAC,SAAS,EAAE,GAAG,QAAQ,CAAC,EAAE;YACrD,QAAQ;QACV;IACF;IAEA,YAAY;IACZ,MAAM,aAAa,MAA0C,EAAwC;QACnG,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,IAAI,CAAC,OAAO,CAA8B,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IAC1F;IAEA,MAAM,YAAY,EAAU,EAAqB;QAC/C,OAAO,IAAI,CAAC,OAAO,CAAW,CAAC,WAAW,EAAE,IAAI;IAClD;IAEA,MAAM,eAAe,IAIpB,EAAqB;QACpB,OAAO,IAAI,CAAC,OAAO,CAAW,cAAc;YAC1C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,eAAe,EAAU,EAAE,IAG/B,EAAqB;QACrB,OAAO,IAAI,CAAC,OAAO,CAAW,CAAC,WAAW,EAAE,IAAI,EAAE;YAChD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,eAAe,EAAU,EAAiB;QAC9C,OAAO,IAAI,CAAC,OAAO,CAAO,CAAC,WAAW,EAAE,IAAI,EAAE;YAC5C,QAAQ;QACV;IACF;IAEA,MAAM,gBAAgB,UAAkB,EAAE,SAAiB,EAAE,QAAiB,EAAyB;QACrG,OAAO,IAAI,CAAC,OAAO,CAAe,CAAC,WAAW,EAAE,WAAW,MAAM,CAAC,EAAE;YAClE,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAW;YAAS;QAC7C;IACF;IAEA,MAAM,mBAAmB,UAAkB,EAAE,MAAc,EAAiB;QAC1E,OAAO,IAAI,CAAC,OAAO,CAAO,CAAC,WAAW,EAAE,WAAW,OAAO,EAAE,QAAQ,EAAE;YACpE,QAAQ;QACV;IACF;IAEA,YAAY;IACZ,MAAM,aAAa,MAA0C,EAAE;QAC7D,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,IAAI,CAAC,OAAO,CAAM,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IAClE;IAEA,MAAM,eAAe,IAAS,EAAE;QAC9B,OAAO,IAAI,CAAC,OAAO,CAAM,cAAc;YACrC,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,eAAe,EAAU,EAAE,IAAS,EAAE;QAC1C,OAAO,IAAI,CAAC,OAAO,CAAM,CAAC,WAAW,EAAE,IAAI,EAAE;YAC3C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,eAAe,EAAU,EAAE;QAC/B,OAAO,IAAI,CAAC,OAAO,CAAM,CAAC,WAAW,EAAE,IAAI,EAAE;YAC3C,QAAQ;QACV;IACF;AACF;AAEO,MAAM,YAAY,IAAI,UAAU"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/lib/hooks/useAuth.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { apiClient } from '@/lib/api';\n\ninterface User {\n  id: string;\n  email: string;\n  organizationId: string;\n  organizationName?: string;\n  role?: string;\n}\n\nexport function useAuth() {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadUser();\n  }, []);\n\n  const loadUser = async () => {\n    try {\n      setLoading(true);\n      // Try to get user info from token or API\n      const token = localStorage.getItem('authToken');\n      if (!token) {\n        setUser(null);\n        return;\n      }\n\n      // Decode JWT to get user info (basic implementation)\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        setUser({\n          id: payload.sub || payload.userId,\n          email: payload.email,\n          organizationId: payload.organizationId,\n          organizationName: payload.organizationName,\n          role: payload.role,\n        });\n      } catch (e) {\n        console.error('Failed to decode token:', e);\n        setUser(null);\n      }\n    } catch (err: any) {\n      setError(err.message);\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const logout = () => {\n    apiClient.clearToken();\n    setUser(null);\n    window.location.href = '/login';\n  };\n\n  return {\n    user,\n    loading,\n    error,\n    isAuthenticated: !!user,\n    logout,\n    reload: loadUser,\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAUO,SAAS;IACd,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gUAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gUAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gUAAQ,EAAgB;IAElD,IAAA,iUAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,MAAM,WAAW;QACf,IAAI;YACF,WAAW;YACX,yCAAyC;YACzC,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,CAAC,OAAO;gBACV,QAAQ;gBACR;YACF;YAEA,qDAAqD;YACrD,IAAI;gBACF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;gBACnD,QAAQ;oBACN,IAAI,QAAQ,GAAG,IAAI,QAAQ,MAAM;oBACjC,OAAO,QAAQ,KAAK;oBACpB,gBAAgB,QAAQ,cAAc;oBACtC,kBAAkB,QAAQ,gBAAgB;oBAC1C,MAAM,QAAQ,IAAI;gBACpB;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,QAAQ;YACV;QACF,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO;YACpB,QAAQ;QACV,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,SAAS;QACb,qIAAS,CAAC,UAAU;QACpB,QAAQ;QACR,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,OAAO;QACL;QACA;QACA;QACA,iBAAiB,CAAC,CAAC;QACnB;QACA,QAAQ;IACV;AACF"}},
    {"offset": {"line": 354, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/vizora/vizora/web/src/app/dashboard/layout.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { useState } from 'react';\nimport { useAuth } from '@/lib/hooks/useAuth';\n\nconst navigation = [\n  { name: 'Overview', href: '/dashboard', icon: 'üìä', exactMatch: true },\n  { name: 'Devices', href: '/dashboard/devices', icon: 'üì∫' },\n  { name: 'Content', href: '/dashboard/content', icon: 'üñºÔ∏è' },\n  { name: 'Playlists', href: '/dashboard/playlists', icon: 'üìã' },\n  { name: 'Schedules', href: '/dashboard/schedules', icon: 'üìÖ' },\n  { name: 'Analytics', href: '/dashboard/analytics', icon: 'üìà' },\n  { name: 'Settings', href: '/dashboard/settings', icon: '‚öôÔ∏è' },\n];\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const pathname = usePathname();\n  const router = useRouter();\n  const { user, loading: authLoading, logout: handleLogoutAuth } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n\n  const isActive = (item: typeof navigation[0]) => {\n    if (item.exactMatch) {\n      return pathname === item.href;\n    }\n    return pathname.startsWith(item.href);\n  };\n\n  const handleLogout = () => {\n    handleLogoutAuth();\n  };\n\n  // Get user initials for avatar\n  const getUserInitials = () => {\n    if (!user?.email) return 'U';\n    const parts = user.email.split('@')[0].split('.');\n    if (parts.length >= 2) {\n      return (parts[0][0] + parts[1][0]).toUpperCase();\n    }\n    return user.email.substring(0, 2).toUpperCase();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b border-gray-200 fixed top-0 left-0 right-0 z-30\">\n        <div className=\"px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center gap-4\">\n              <button\n                onClick={() => setSidebarOpen(!sidebarOpen)}\n                className=\"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition lg:hidden\"\n              >\n                <svg\n                  className=\"w-6 h-6\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M4 6h16M4 12h16M4 18h16\"\n                  />\n                </svg>\n              </button>\n              <Link href=\"/dashboard\" className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center\">\n                  <span className=\"text-white font-bold text-lg\">V</span>\n                </div>\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n                  Vizora\n                </h1>\n              </Link>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              {!authLoading && user && (\n                <div className=\"hidden sm:flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg\">\n                  <div \n                    className=\"w-8 h-8 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center\"\n                    aria-label={`${user.email} avatar`}\n                  >\n                    <span className=\"text-white text-sm font-semibold\">{getUserInitials()}</span>\n                  </div>\n                  <div className=\"hidden md:block\">\n                    <div className=\"text-sm font-medium text-gray-900\">{user.email.split('@')[0]}</div>\n                    <div className=\"text-xs text-gray-500\">{user.email}</div>\n                  </div>\n                </div>\n              )}\n              <button\n                onClick={handleLogout}\n                className=\"text-sm text-red-600 hover:text-red-700 hover:bg-red-50 px-4 py-2 rounded-lg transition font-medium\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"flex pt-16\">\n        {/* Sidebar */}\n        <aside\n          className={`${\n            sidebarOpen ? 'translate-x-0' : '-translate-x-full'\n          } fixed lg:relative lg:translate-x-0 w-64 bg-white min-h-[calc(100vh-4rem)] border-r border-gray-200 transition-transform duration-300 ease-in-out z-20`}\n        >\n          <nav className=\"p-4 space-y-1\">\n            {navigation.map((item) => {\n              const active = isActive(item);\n              return (\n                <Link\n                  key={item.name}\n                  href={item.href}\n                  onClick={() => setSidebarOpen(false)}\n                  className={`flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium transition-all ${\n                    active\n                      ? 'bg-gradient-to-r from-blue-50 to-purple-50 text-blue-700 shadow-sm'\n                      : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'\n                  }`}\n                >\n                  <span className=\"text-xl\">{item.icon}</span>\n                  <span className=\"flex-1\">{item.name}</span>\n                  {active && (\n                    <span className=\"w-2 h-2 bg-blue-600 rounded-full\"></span>\n                  )}\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* Sidebar Footer */}\n          <div className=\"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-gradient-to-br from-blue-50 to-purple-50\">\n            <div className=\"text-xs text-gray-600 space-y-1\">\n              <div className=\"flex justify-between\">\n                <span>Version</span>\n                <span className=\"font-semibold\">1.0.0</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Status</span>\n                <span className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></span>\n                  <span className=\"font-semibold text-green-600\">Online</span>\n                </span>\n              </div>\n            </div>\n          </div>\n        </aside>\n\n        {/* Overlay for mobile */}\n        {sidebarOpen && (\n          <div\n            className=\"fixed inset-0 bg-black bg-opacity-50 z-10 lg:hidden\"\n            onClick={() => setSidebarOpen(false)}\n          />\n        )}\n\n        {/* Main content */}\n        <main className=\"flex-1 p-4 sm:p-6 lg:p-8 min-h-[calc(100vh-4rem)] overflow-x-hidden\">\n          <div className=\"max-w-7xl mx-auto\">{children}</div>\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}